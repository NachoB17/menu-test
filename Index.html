<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Menu ‚Äì Maison Fleurie</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0; padding: 0; height: 100%;
      font-family: 'Quicksand', Arial, sans-serif;
      background: #f8f9fa;
    }
    .header {
      background: linear-gradient(135deg, #2c5530 0%, #4a7c59 100%);
      color: white; padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .header h1 { margin: 0; font-size: 1.8rem; font-weight: 700; }
    .header p { margin: 0.3rem 0 0 0; opacity: 0.9; font-size: 1.05rem; }
    .tab-nav {
      display: flex; background: white; border-bottom: 1px solid #e9ecef;
      overflow-x: auto; position: sticky; top: 0; z-index: 100;
    }
    .tab-btn {
      flex: 1; min-width: 120px; padding: 1rem 0.5rem; border: none;
      background: none; cursor: pointer; font-size: 1rem;
      font-weight: 700; color: #6c757d; transition: all 0.2s;
    }
    .tab-btn.active {
      color: #2c5530; border-bottom: 3px solid #2c5530; background: #f8f9fa;
    }
    .tab-content { display: none; padding: 1.2rem 1rem; }
    .tab-content.active { display: block; }
    .pdf-container { width: 100vw; max-width: 100vw; background: white; border-radius: 8px; overflow: hidden; margin: 0 auto; }
    .pdf-viewer { width: 100vw; height: 80vh; min-height: 400px; border: none; display: block; }
    @media (max-width: 600px) { .pdf-viewer { height: 90vh; min-height: 320px; } }
    .section-title {
      color: #2c5530; font-size: 1.2rem; font-weight: 700; margin-bottom: 0.7rem;
      border-bottom: 2px solid #e9ecef; letter-spacing: 1px;
      font-family: 'Quicksand', Arial, sans-serif;
    }
    .menu-item {
      display: flex; justify-content: space-between; align-items: flex-start;
      padding: 0.7rem 0; border-bottom: 1px solid #f1f3f4;
      font-size: 1.05rem;
    }
    .item-info { flex: 1; margin-right: 1rem; }
    .item-name { font-weight: 700; color: #212529; margin-bottom: 0.3rem; }
    .item-description { color: #6c757d; font-size: 0.95rem; }
    .item-price { color: #2c5530; font-weight: 700; font-size: 1.1rem; flex-shrink: 0; }
    .csv-error { color: #e74c3c; text-align: center; padding: 1em; }
  </style>
</head>
<body>
  <div class="header">
    <h1>MAISON FLEURIE</h1>
    <p>Table des Mets ‚Ä¢ Cocktails ‚Ä¢ Vins</p>
  </div>
  <div class="container">
    <div class="tab-nav">
      <button class="tab-btn active" onclick="showTab('pdf')">üìÑ Menu PDF</button>
      <button class="tab-btn" onclick="showTab('deguster')">üçΩÔ∏è D√©guster</button>
      <button class="tab-btn" onclick="showTab('cocktails')">üç∏ Cocktails</button>
      <button class="tab-btn" onclick="showTab('hotdrinks')">‚òï Boissons chaudes</button>
      <button class="tab-btn" onclick="showTab('beers')">üç∫ Bi√®res pression & bouteilles</button>
      <button class="tab-btn" onclick="showTab('wines')">üç∑ Vins</button>
    </div>
    <!-- Onglet PDF -->
    <div id="pdf" class="tab-content active">
      <div class="pdf-container">
        <iframe src="menu.pdf" class="pdf-viewer" title="Menu PDF Maison Fleurie"></iframe>
      </div>
      <div style="text-align:center; margin:1rem;">
        <a href="menu.pdf" target="_blank" style="color:#2c5530; font-weight:bold; text-decoration:underline;">T√©l√©charger le menu PDF</a>
      </div>
    </div>
    <!-- Contenus dynamiques (via CSV) -->
    <div id="deguster" class="tab-content"></div>
    <div id="cocktails" class="tab-content"></div>
    <div id="hotdrinks" class="tab-content"></div>
    <div id="beers" class="tab-content"></div>
    <div id="wines" class="tab-content"></div>
  </div>
  <!-- Papaparse for CSV reading -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script>
    function showTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');
    }
    // Load CSV and fill tabs
    function renderCSVMenu(csvRows) {
      // Cat√©gories par onglet
      const tabs = {
        deguster: document.getElementById('deguster'),
        cocktails: document.getElementById('cocktails'),
        hotdrinks: document.getElementById('hotdrinks'),
        beers: document.getElementById('beers'),
        wines: document.getElementById('wines')
      };
      // Vide tout avant d‚Äôinjecter
      for (const tab in tabs) tabs[tab].innerHTML = "";
      // Grouper par section pour chaque onglet
      const data = {};
      csvRows.forEach(row => {
        const onglet = (row.Onglet || '').toLowerCase();
        if (!tabs[onglet]) return;
        if (!data[onglet]) data[onglet] = {};
        const section = row.Section || '';
        if (!data[onglet][section]) data[onglet][section] = [];
        data[onglet][section].push(row);
      });
      // Injecte dans chaque tab
      Object.keys(tabs).forEach(tabKey => {
        const tab = tabs[tabKey];
        if (!data[tabKey]) return tab.innerHTML = "<div class='csv-error'>Aucune donn√©e pour cet onglet</div>";
        let html = "";
        Object.keys(data[tabKey]).forEach(section => {
          html += `<h2 class="section-title">${section}</h2>`;
          data[tabKey][section].forEach(item => {
            html += `
              <div class="menu-item">
                <div class="item-info">
                  <div class="item-name">${item.Nom || ""}</div>
                  ${item.Description ? `<div class="item-description">${item.Description}</div>` : ""}
                </div>
                <div class="item-price">${item.Prix || ""}</div>
              </div>`;
          });
        });
        tab.innerHTML = html;
      });
    }
    function fetchCSVAndRender() {
      Papa.parse('menu.csv', {
        download: true,
        header: true,
        complete: function(results) {
          if (results.errors && results.errors.length > 0) {
            document.getElementById('deguster').innerHTML = "<div class='csv-error'>Erreur CSV : " + results.errors[0].message + "</div>";
          } else {
            renderCSVMenu(results.data);
          }
        },
        error: function(err) {
          document.getElementById('deguster').innerHTML = "<div class='csv-error'>Erreur de chargement du CSV</div>";
        }
      });
    }
    // Appel au chargement
    window.addEventListener('DOMContentLoaded', fetchCSVAndRender);
  </script>
</body>
</html>
